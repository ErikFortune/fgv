name: Publish to npm

on:
  workflow_dispatch:
    inputs:
      release_type:
        description: 'Release type'
        required: true
        type: choice
        options:
          - release
          - alpha
          - major

permissions:
  id-token: write # Required for npm OIDC
  contents: write # Required for git commits (version bumps)

jobs:
  publish-release:
    if: ${{ github.event.inputs.release_type == 'release' }}
    uses: ./.github/workflows/publish-release-impl.yml
    permissions:
      id-token: write
      contents: write
    secrets: inherit

  publish-alpha:
    if: ${{ github.event.inputs.release_type == 'alpha' }}
    uses: ./.github/workflows/publish-alpha-impl.yml
    permissions:
      id-token: write
      contents: write
    secrets: inherit

  publish-major:
    if: ${{ github.event.inputs.release_type == 'major' }}
    uses: ./.github/workflows/publish-major-impl.yml
    permissions:
      id-token: write
      contents: write
    secrets: inherit
